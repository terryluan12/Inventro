{% extends "base.html" %} {% load static %} {% block content %}
<div class="layout">
  <aside class="sidebar">
    <div class="brand">
      <div class="brand-icon"><i class="bi bi-box-seam"></i></div>
      <div>
        <div class="brand-title">Inventro</div>
        <div class="brand-sub">Inventory Platform</div>
      </div>
    </div>

    <nav class="menu">
      <div>
        <div class="menu-heading">Main</div>
        <a
          class="menu-link {% if request.path == '/dashboard/' %}active{% endif %}"
          href="{% url 'dashboard_home' %}"
        >
          <i class="bi bi-speedometer2"></i> Dashboard
        </a>
        <a
          class="menu-link {% if request.path == '/inventory/' %}active{% endif %}"
          href="{% url 'dashboard_inventory' %}"
        >
          <i class="bi bi-archive"></i> Inventory
        </a>
      <div>
        <a
          class="menu-link {% if request.path == '/my_inventory/' %}active{% endif %}"
          href="{% url 'user_inventory_page' %}"
        >
          <i class="bi bi-graph-up"></i> My Inventory
        </a>
      </div>
      </div>

      {% if user.is_staff or user.is_superuser %}
      <div>
        <div class="menu-heading">Staff</div>
        <a
          class="menu-link {% if request.path == '/item/' %}active{% endif %}"
          href="{% url 'dashboard_add_item' %}"
        >
          <i class="bi bi-plus-circle"></i> Add Item
        </a>
      </div>
      {% endif %} {% if user.is_superuser %}
      <div>
        <div class="menu-heading">Admin</div>
        <a
          class="menu-link {% if request.path == '/analytics/' %}active{% endif %}"
          href="{% url 'dashboard_analytics' %}"
        >
          <i class="bi bi-graph-up"></i> Analytics
        </a>
        <a
          class="menu-link {% if request.path == '/user/add' %}active{% endif %}"
          href="{% url 'dashboard_add_user' %}"
        >
          <i class="bi bi-person-plus"></i> Add User
        </a>
      </div>
      {% endif %}
    </nav>

    <div class="sidebar-footer">
      <div class="avatar">HS</div>
      <div class="user-meta">
        <div class="user-name">
          {% if user.is_authenticated %}{{ user.username }}{% else %}Guest{% endif %}
        </div>
        <div class="user-role">
          {% if user.is_superuser %}Admin{% elif user.is_staff %}Manager{% elif
          user.is_authenticated %}Staff{% else %}Not signed in{% endif %}
        </div>
      </div>

      {% if user.is_authenticated %}
      <a
        id="logout-link"
        class="logout"
        href="{% url 'logout' %}"
        title="Sign out"
        ><i class="bi bi-box-arrow-right"></i
      ></a>
      {% else %}
      <a id="login-link" class="logout" href="{% url 'login' %}" title="Sign in"
        ><i class="bi bi-box-arrow-in-right"></i
      ></a>
      {% endif %}
    </div>
  </aside>

  <main class="main">
    {% if messages %}
    <div
      id="toast-container"
      style="position: fixed; top: 1rem; right: 1rem; z-index: 10800"
    >
      {% for message in messages %}
      <div
        class="toast align-items-center text-bg-{{ message.tags|default:'info' }} border-0 mb-2"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
        data-bs-delay="5000"
      >
        <div class="d-flex">
          <div class="toast-body">{{ message }}</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>
      {% endfor %}
    </div>
    {% endif %}
    
      {% block main %}{% endblock %}
  </main>
</div>

<script src="{% static 'dashboard/ui.js' %}"></script>
<script src="{% static 'dashboard/app.js' %}"></script>

<script>
  // Minimal client-side hooks for dashboard
  document.addEventListener("DOMContentLoaded", function () {
    if (typeof initDashboard === "function") initDashboard();
  });
</script>

{% endblock %}
